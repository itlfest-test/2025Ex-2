<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>ã‚¤ãƒ™ãƒ³ãƒˆè©³ç´° - å­¦ç¥­ã‚¤ãƒ™ãƒ³ãƒˆæ¤œç´¢</title>
  <link rel="stylesheet" href="styles.css">
</head>
<body>
  <div class="max-w-4xl mx-auto p-4">
    <div style="margin-bottom: 20px;">
      <a href="index.html" style="color: #2563eb; text-decoration: none; font-size: 14px;">â† æ¤œç´¢ãƒšãƒ¼ã‚¸ã«æˆ»ã‚‹</a>
    </div>

    <div id="event-detail-content" style="background: white; border-radius: 8px; padding: 20px; box-shadow: 0 2px 4px rgba(0,0,0,0.1);">
      <div style="text-align: center; padding: 40px; color: #666;">èª­ã¿è¾¼ã¿ä¸­...</div>
    </div>
  </div>

  <script>
    // URLãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã‹ã‚‰ã‚¤ãƒ™ãƒ³ãƒˆIDã‚’å–å¾—
    const urlParams = new URLSearchParams(window.location.search);
    const eventId = urlParams.get('id');

    if (!eventId) {
      document.getElementById('event-detail-content').innerHTML = `
        <div style="text-align: center; padding: 40px; color: #c33;">
          <h2>ã‚¨ãƒ©ãƒ¼</h2>
          <p>ã‚¤ãƒ™ãƒ³ãƒˆIDãŒæŒ‡å®šã•ã‚Œã¦ã„ã¾ã›ã‚“ã€‚</p>
          <a href="index.html" style="color: #2563eb;">æ¤œç´¢ãƒšãƒ¼ã‚¸ã«æˆ»ã‚‹</a>
        </div>
      `;
    } else {
      loadEventDetail(eventId);
    }

    async function loadEventDetail(id) {
      try {
        const response = await fetch('data/events.json');
        const events = await response.json();
        const event = events.find(e => e.id == id);

        if (!event) {
          document.getElementById('event-detail-content').innerHTML = `
            <div style="text-align: center; padding: 40px; color: #c33;">
              <h2>ã‚¤ãƒ™ãƒ³ãƒˆãŒè¦‹ã¤ã‹ã‚Šã¾ã›ã‚“</h2>
              <p>æŒ‡å®šã•ã‚ŒãŸã‚¤ãƒ™ãƒ³ãƒˆï¼ˆID: ${id}ï¼‰ã¯å­˜åœ¨ã—ã¾ã›ã‚“ã€‚</p>
              <a href="index.html" style="color: #2563eb;">æ¤œç´¢ãƒšãƒ¼ã‚¸ã«æˆ»ã‚‹</a>
            </div>
          `;
          return;
        }

        // ã‚¤ãƒ™ãƒ³ãƒˆè©³ç´°ã‚’è¡¨ç¤º
        const name = event.name || event["ä¼ç”»å"] || "(ç„¡é¡Œ)";
        const subtitle = event.subtitle || event["ã‚µãƒ–ã‚¿ã‚¤ãƒˆãƒ«"] || "";
        const description = event.description || event["èª¬æ˜"] || "";
        const university = event.university || event["å¤§å­¦"] || "";
        const category = event.category || event["ã‚«ãƒ†ã‚´ãƒª"] || "";
        const field = event.field || event["åˆ†é‡"] || "";
        const startDatetime = event.startDatetime || event.start_datetime || event["start_datetime"] || "";
        const endDatetime = event.endDatetime || event.end_datetime || event["end_datetime"] || "";
        const location = event.location || event["å ´æ‰€"] || "";

        // æ—¥æ™‚ãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆ
        let dateTimeStr = "";
        if (startDatetime) {
          try {
            const start = new Date(startDatetime);
            const year = start.getFullYear();
            const month = start.getMonth() + 1;
            const day = start.getDate();
            const weekdays = ["æ—¥", "æœˆ", "ç«", "æ°´", "æœ¨", "é‡‘", "åœŸ"];
            const weekday = weekdays[start.getDay()];
            const startHour = String(start.getHours()).padStart(2, '0');
            const startMin = String(start.getMinutes()).padStart(2, '0');
            
            dateTimeStr = `${year}å¹´${month}æœˆ${day}æ—¥ï¼ˆ${weekday}ï¼‰ ${startHour}:${startMin}`;
            
            if (endDatetime) {
              const end = new Date(endDatetime);
              const endHour = String(end.getHours()).padStart(2, '0');
              const endMin = String(end.getMinutes()).padStart(2, '0');
              dateTimeStr += `ï½${endHour}:${endMin}`;
            }
          } catch (e) {
            dateTimeStr = startDatetime;
          }
        }

        document.getElementById('event-detail-content').innerHTML = `
          <h1 style="font-size: 28px; font-weight: bold; color: #1e40af; margin-bottom: 8px;">${escapeHtml(name)}</h1>
          ${subtitle ? `<p style="font-size: 18px; color: #666; margin-bottom: 20px;">${escapeHtml(subtitle)}</p>` : ''}
          
          <div style="display: flex; gap: 8px; flex-wrap: wrap; margin-bottom: 20px;">
            <span style="background: #dbeafe; color: #1e40af; padding: 6px 12px; border-radius: 4px; font-size: 14px;">${escapeHtml(university)}</span>
            <span style="background: #fef3c7; color: #92400e; padding: 6px 12px; border-radius: 4px; font-size: 14px;">${escapeHtml(category)}</span>
            <span style="background: #e0e7ff; color: #4338ca; padding: 6px 12px; border-radius: 4px; font-size: 14px;">${escapeHtml(field)}</span>
          </div>

          ${dateTimeStr ? `
            <div style="background: #f3f4f6; padding: 16px; border-radius: 8px; margin-bottom: 20px;">
              <div style="font-weight: 600; color: #374151; margin-bottom: 8px;">ğŸ“… é–‹å‚¬æ—¥æ™‚</div>
              <div style="color: #1f2937;">${escapeHtml(dateTimeStr)}</div>
            </div>
          ` : ''}

          ${location ? `
            <div style="background: #f3f4f6; padding: 16px; border-radius: 8px; margin-bottom: 20px;">
              <div style="font-weight: 600; color: #374151; margin-bottom: 8px;">ğŸ“ å ´æ‰€</div>
              <div style="color: #1f2937;">${escapeHtml(location)}</div>
            </div>
          ` : ''}

          <div style="background: #f9fafb; padding: 20px; border-radius: 8px; margin-bottom: 20px;">
            <div style="font-weight: 600; color: #374151; margin-bottom: 12px; font-size: 18px;">ğŸ“ è©³ç´°èª¬æ˜</div>
            <div style="color: #1f2937; line-height: 1.8; white-space: pre-wrap;">${escapeHtml(description)}</div>
          </div>

          <div style="text-align: center; margin-top: 30px;">
            <a href="index.html" style="display: inline-block; background: #2563eb; color: white; padding: 12px 32px; border-radius: 8px; text-decoration: none; font-weight: 500;">æ¤œç´¢ãƒšãƒ¼ã‚¸ã«æˆ»ã‚‹</a>
          </div>
        `;

      } catch (error) {
        console.error('ãƒ‡ãƒ¼ã‚¿èª­ã¿è¾¼ã¿ã‚¨ãƒ©ãƒ¼:', error);
        document.getElementById('event-detail-content').innerHTML = `
          <div style="text-align: center; padding: 40px; color: #c33;">
            <h2>ã‚¨ãƒ©ãƒ¼</h2>
            <p>ãƒ‡ãƒ¼ã‚¿ã®èª­ã¿è¾¼ã¿ã«å¤±æ•—ã—ã¾ã—ãŸã€‚</p>
            <a href="index.html" style="color: #2563eb;">æ¤œç´¢ãƒšãƒ¼ã‚¸ã«æˆ»ã‚‹</a>
          </div>
        `;
      }
    }

    function escapeHtml(str) {
      if (!str && str !== 0) return "";
      return String(str)
        .replaceAll("&", "&amp;")
        .replaceAll("<", "&lt;")
        .replaceAll(">", "&gt;")
        .replaceAll('"', "&quot;")
        .replaceAll("'", "&#39;");
    }
  </script>
</body>
</html>
